{% from "components/folder-path.html" import copy_folder_path, page_title_folder_path %}
{% from "components/live-search.html" import live_search %}

{% extends "admin_template.html" %}

{% block service_page_title %}
  {{ _('Copy an existing template') }}
{% endblock %}

{% block maincolumn_content %}

    <div class="mb-12 clear-both contain-floats">
      <h1>{{ _('Copy an existing template') }}</h1>
      {{ copy_folder_path(template_folder_path, current_service.id, from_service, current_user) }}
    </div>
    {% if not services_templates_and_folders.templates_to_show %}
      <p class="notifications-template-list-empty">
        {{ _('This folder is empty') }}
      </p>
    {% else %}
      {{ live_search(target_selector='#template-list .template-list-item', show=True, form=search_form) }}
      <nav id="template-list">
        {% for item in services_templates_and_folders %}
          <div class="template-list-item {% if item.ancestors %}template-list-item-hidden-by-default{% endif %} {% if not item.ancestors %}template-list-item-without-ancestors{% endif %}">
            <h2 class="notifications-message-name">
              {% for ancestor in item.ancestors %}
                {% if ancestor.is_service %}
                  <a class="notifications-template-list-folder" href="{{ url_for('.choose_template_to_copy', service_id=current_service.id, from_service=ancestor.service_id) }}">
                {% else %}
                  <a class="notifications-template-list-folder" href="{{ url_for('.choose_template_to_copy', service_id=current_service.id, from_folder=ancestor.id) }}">
                {% endif %}
                  {{ ancestor.name }}
                </a> <span></span>
              {% endfor %}
              {% if item.is_service %}
                <a class="notifications-template-list-folder" href="{{ url_for('.choose_template_to_copy', service_id=current_service.id, from_service=item.service_id) }}">
                  <span class="live-search-relevant">{{ item.name }}</span>
                </a>
              {% elif item.is_folder %}
                <a class="notifications-template-list-folder" href="{{ url_for('.choose_template_to_copy', service_id=current_service.id, from_service=item.service_id, from_folder=item.id) }}">
                  <span class="live-search-relevant">{{ item.name }}</span>
                </a>
              {% else %}
                <a href="{{ url_for('.copy_template', service_id=current_service.id, template_id=item.id, from_service=item.service_id) }}">
                  <span class="live-search-relevant">{{ item.name }}</span>
                </a>
              {% endif %}
            </h2>
            <p>
              {{ _(item.hint) }}
            </p>
          </div>
        {% endfor %}
      </nav>
    {% endif %}

{% endblock %}
